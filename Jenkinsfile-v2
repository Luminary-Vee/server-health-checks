pipeline {
    agent any

    stages {
        stage('Run Health Check') {
            steps {
                bat '''
                    echo Starting server health check... > server_health.log
                    call health_check.sh >> server_health.log 2>&1
                '''
            }
        }

        stage('Display Log') {
            steps {
                bat 'type server_health.log'
            }
        }

        stage('Archive Logs') {
            steps {
                archiveArtifacts artifacts: 'server_health.log', fingerprint: true
            }
        }
    }
}
